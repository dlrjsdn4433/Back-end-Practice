<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
<properties>
    <!--주문자 관련 쿼리 xml
        1-1. 매장 전체 조회 -> 매장 이름 출력
        1-2. 매장 이름 검색 조회 -> 메뉴이름 메뉴가격 출력
        1-3. 메뉴 이름 검색 조회
        2-1. 주문 추가
        2-2. 주문 수정
        2-3. 주문 삭제
        2-4. 주문 조회
        3-1. 리뷰 작성
        3-2. 리뷰 수정
        3-3. 리뷰 삭제
        3-4. 리뷰 조회 // 주문코드랑 매장이름만나오게
        -->
    <entry key="viewAllStore">
        select
            *
            from store;
    </entry>
    <entry key="searchStore">
        select
            menu_name,
            menu_price,
            cooking_time,
            orderable_status
            from menu
            where store_code = (select
                                    store_code
                                    from store
                                    where store_name = ?);
    </entry>
    <entry key="searchMenuName">
        select
            a.store_name,
            b.menu_name,
            b.menu_price
            from store a
            join menu b on a.store_code = b.store_code
            where b.menu_name = ?;
    </entry>
    <entry key="order">
        insert into orders
        (order_code, delivery_time,user_code,menu_name,menu_amount,store_code,total_price)
        values(
        null,
        ?+(select cooking_time from menu where menu_name = ? and store_code =(select store_code from store where store_name = ?)),
        ?,
        ?,
        ?,
        (select store_code from store where store_name = ?),
        (select menu_price from menu where menu_name = ? and store_code = (select store_code from store where store_name = ?))*?+?);
    </entry>
    <entry key="modifyOrder">
        update orders
            set menu_amount = ?
            where order_code = ?
              and user_code = ?;
    </entry>
    <entry key="deleteOrder">
        delete from orders
            where order_code = ?
              and user_code = ?;
    </entry>
    <entry key="viewMyOrder">
        select
                *
                from orders
                where user_code = ?;
    </entry>
    <entry key="viewMyOrderWithoutReview">
        select
                *
                from orders
                where user_code = ?
                  and review_status = 'N';
    </entry>
    <entry key="registReview">
        insert into review
        values(
        ?,
        ?,
        (select store_code from orders where order_code = ?),
        ?);
    </entry>
    <entry key="updateOrders">
        update orders
        set review_status = 'y'
        where order_code = ?
        and user_code = ?;
    </entry>
    <entry key="modifyReview">
        update review
            set review = ?
            where order_code = ?
              and user_code = ?;
    </entry>
    <entry key="deleteReview">
        delete from review
            where order_code = ?
              and user_code = ?;
    </entry>
    <entry key="viewMyReview">
        select *
        from review
        where user_code = ?;
    </entry>
</properties>